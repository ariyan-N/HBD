<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HBD Love</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<link rel="stylesheet" href="./file/default.css">
<script src="./file/jquery.min.js"></script>
<script src="./file/jscex.min.js"></script>
<script src="./file/jscex-parser.js"></script>
<script src="./file/jscex-jit.js"></script>
<script src="./file/jscex-builderbase.min.js"></script>
<script src="./file/jscex-async.min.js"></script>
<script src="./file/jscex-async-powerpack.min.js"></script>
<script src="./file/functions.js"></script>
<script src="./file/love.js"></script>

<style>
html, body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  background:black;
  font-family: system-ui, sans-serif;
}

/* üé• Background video */
#bg-video{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  opacity:0.18;
  z-index:-2;
}

/* overlay */
#overlay{
  position:fixed;
  inset:0;
  background:rgba(255,255,255,0.45);
  z-index:-1;
}

#main,#wrap{
  width:100%;
  height:100%;
  position:relative;
}

#canvas{
  width:100%;
  height:100%;
  display:block;
}

/* üíå Wish card (Secret Surprise style) */
#wish-box{
  position:absolute;
  top:8%;
  left:50%;
  transform:translateX(-50%);
  width:90%;
  max-width:360px;
  padding:32px;
  text-align:center;
  background:rgba(0,0,0,.6);
  backdrop-filter: blur(14px);
  border-radius:22px;
  color:white;
  display:none;
  z-index:5;
  animation:fade .8s ease;
}

#wish-box span{
  display:block;
  margin:6px 0;
  font-size:1rem;
}

#wish-box span:first-child{
  font-weight:600;
  font-size:1.1rem;
  color:#ff4ecd;
}

/* ‚è± Clock */
#clock-box{
  position:absolute;
  bottom:6%;
  width:100%;
  text-align:center;
  z-index:5;
}

/* Button animation */
@keyframes fade{
  from{opacity:0; transform:scale(.95);}
  to{opacity:1; transform:scale(1);}
}
</style>
</head>

<body>

<!-- BACKGROUND VIDEO -->
<video id="bg-video" autoplay muted loop playsinline>
  <source src="./main/video.mp4" type="video/mp4">
</video>

<div id="overlay"></div>

<div id="main">
  <audio id="myAudio">
    <source src="aud.mp3" type="audio/mp3">
  </audio>

  <div id="wrap">

    <!-- üéÅ Wish card -->
    <div id="wish-box">
      <span>My beautiful wife üíû</span>
      <span>Happy Birthday üéà</span>
      <span>May Allah bless you üçÄ</span>
      <span>And give you many happiness üíï</span>
      <span>I loved you ‚ù§Ô∏è</span>
      <span>I will always love you ü•∫‚ù§Ô∏è</span>
    </div>

    <!-- ‚è± Clock -->
    <div id="clock-box">
      <span id="clock">577 days 0 hours 0 minutes 0 seconds</span>
    </div>

    <!-- üå≥ Tree canvas -->
    <canvas id="canvas"></canvas>

  </div>
</div>

<script>
(function(){

  var canvas = $('#canvas');
  var width = window.innerWidth;
  var height = window.innerHeight;

  canvas.attr("width", width);
  canvas.attr("height", height);

  var sx = width/1100;
  var sy = height/680;

  var opts = {
    seed:{x:width/2-20,color:"rgb(190,26,37)",scale:2},
    branch:[[535*sx,680*sy,570*sx,250*sy,500*sx,200*sy,30,100]],
    bloom:{num:650,width:width,height:height},
    footer:{width:width,height:5,speed:10}
  };

  var tree = new Tree(canvas[0],width,height,opts);
  var seed = tree.seed;
  var foot = tree.footer;
  var hold = 1;

  /* üî• Big canvas click for animation + audio */
  canvas.on("click touchstart",function(){
    document.getElementById("myAudio").play();
    hold = 0;
  });

  var seedAnimate = eval(Jscex.compile("async",function(){
    seed.draw();
    while(hold)$await(Jscex.Async.sleep(10));
    while(seed.canScale()){
      seed.scale(0.95);
      $await(Jscex.Async.sleep(10));
    }
    while(seed.canMove()){
      seed.move(0,2);
      foot.draw();
      $await(Jscex.Async.sleep(10));
    }
  }));

  var growAnimate = eval(Jscex.compile("async",function(){
    do{
      tree.grow();
      $await(Jscex.Async.sleep(10));
    }while(tree.canGrow());
  }));

  var flowAnimate = eval(Jscex.compile("async",function(){
    do{
      tree.flower(2);
      $await(Jscex.Async.sleep(10));
    }while(tree.canFlower());
  }));

  var showWish = eval(Jscex.compile("async",function(){
    $("#wish-box").fadeIn(900);
  }));

  var runAsync = eval(Jscex.compile("async",function(){
    $await(seedAnimate());
    $await(growAnimate());
    $await(flowAnimate());
    $await(showWish());
  }));

  runAsync().start();

})();
</script>

</body>
</html>
